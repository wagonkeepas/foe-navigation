<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Faculty of Engineering Navigation</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f0f2f5 0%, #e6e9f0 100%);
      color: #333;
      line-height: 1.6;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    header {
      text-align: center;
      margin-bottom: 25px;
      width: 100%;
    }

    h1 {
      color: #2c3e50;
      font-size: 2.2rem;
      margin-bottom: 5px;
      padding-bottom: 10px;
      border-bottom: 2px solid #3498db;
      display: inline-block;
    }

    .subtitle {
      color: #7f8c8d;
      font-size: 1rem;
      margin-top: 5px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-bottom: 25px;
      width: 100%;
      max-width: 800px;
    }

    select {
      padding: 12px 20px;
      border-radius: 8px;
      border: 2px solid #bdc3c7;
      background-color: white;
      font-size: 16px;
      color: #2c3e50;
      cursor: pointer;
      transition: all 0.3s;
      min-width: 200px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    select:hover, select:focus {
      border-color: #3498db;
      box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2);
      outline: none;
    }

    .map-wrapper {
      width: 90vw;
      height: 70vh;
      background: white;
      border: 3px solid #2c3e50;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      overflow: hidden;
      position: relative;
      margin-bottom: 20px;
    }

    .map-container {
      position: relative;
      width: 100%;
      height: 100%;
      background: #f9f9f9;
      touch-action: none;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .floor-plan {
      position: absolute;
      top: 0;
      left: 0;
      transform-origin: center center;
      pointer-events: none;
      max-width: 100%;
      max-height: 100%;
      transition: transform 0.1s ease;
    }

    .path-overlay {
      position: absolute;
      top: 0;
      left: 0;
      transform-origin: center center;
      pointer-events: none;
      max-width: 100%;
      max-height: 100%;
      opacity: 0.8;
      transition: transform 0.1s ease;
    }

    .map-controls {
      position: absolute;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 10;
    }

    .control-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #3498db;
      color: white;
      border: none;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      transition: all 0.2s;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .control-btn:hover {
      background: #2980b9;
      transform: scale(1.05);
    }

    .instructions {
      text-align: center;
      margin-top: 15px;
      color: #7f8c8d;
      font-size: 0.9rem;
      max-width: 600px;
    }

    .legend {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 15px;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.9rem;
    }

    .color-box {
      width: 15px;
      height: 15px;
      border-radius: 3px;
    }

    .path-color {
      background-color: #e74c3c;
    }

    .start-color {
      background-color: #2ecc71;
    }

    .end-color {
      background-color: #3498db;
    }

    .image-setup {
      margin-top: 20px;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      max-width: 800px;
      width: 100%;
    }

    .image-setup h3 {
      color: #2c3e50;
      margin-bottom: 15px;
      text-align: center;
    }

    .setup-instructions {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .file-structure {
      background: #2c3e50;
      color: white;
      padding: 15px;
      border-radius: 8px;
      font-family: monospace;
      margin: 15px 0;
      line-height: 1.8;
    }

    @media (max-width: 768px) {
      .controls {
        flex-direction: column;
        align-items: center;
      }
      
      select {
        width: 90%;
      }
      
      .map-wrapper {
        height: 60vh;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Faculty of Engineering Navigation</h1>
    <p class="subtitle">Find your way around the engineering building!</p>
  </header>

  <div class="controls">
    <select id="floorSelector">
      <option value="lg.png">Lower Ground Floor</option>
      <option value="g1.png">Ground Floor</option>
      <option value="floor1.png">Floor 1</option>
      <option value="floor2.png">Floor 2</option>
      <option value="floor3.png">Floor 3</option>
    </select>

    <select id="pathSelector">
      <option value="">-- Select Destination --</option>
      <!-- Options will be populated by JavaScript -->
    </select>
  </div>

  <div class="map-wrapper">
    <div class="map-container" id="map-container">
      <img class="floor-plan" id="floor-plan" alt="Floor plan">
      <img class="path-overlay" id="path-overlay" style="display:none;" alt="Path overlay">
    </div>
    
    <div class="map-controls">
      <button class="control-btn" id="zoom-in">+</button>
      <button class="control-btn" id="zoom-out">-</button>
      <button class="control-btn" id="reset-view">â†º</button>
    </div>
  </div>

  <div class="legend">
    <div class="legend-item">
      <div class="color-box path-color"></div>
      <span>Path</span>
    </div>
    <div class="legend-item">
      <div class="color-box start-color"></div>
      <span>Start (Entrance)</span>
    </div>
    <div class="legend-item">
      <div class="color-box end-color"></div>
      <span>Destination</span>
    </div>
  </div>
  <script>
    // DOM elements
    const floorSelector = document.getElementById('floorSelector');
    const pathSelector = document.getElementById('pathSelector');
    const floorImg = document.getElementById('floor-plan');
    const pathImg = document.getElementById('path-overlay');
    const container = document.getElementById('map-container');
    const zoomInBtn = document.getElementById('zoom-in');
    const zoomOutBtn = document.getElementById('zoom-out');
    const resetViewBtn = document.getElementById('reset-view');

    // Define room options for each floor
    const floorOptions = {
      'lg.png': [
        { value: 'path_LG_Storage.png', text: 'Storage Room' },
        { value: 'path_LG_MechLab.png', text: 'Mechanical Lab' }
      ],
      'g1.png': [
        { value: 'path_G1_Entrance.png', text: 'Main Entrance' },
        { value: 'path_G1_Reception.png', text: 'Reception' }
      ],
      'floor1.png': [
        { value: 'path_F1_A101.png', text: 'Room A101 (Lecture Hall)' },
        { value: 'path_F1_A102.png', text: 'Room A102 (Lab)' }
      ],
      'floor2.png': [
        { value: 'path_F2_B201.png', text: 'Room B201 (Faculty Offices)' },
        { value: 'path_F2_B202.png', text: 'Room B202 (Conference Room)' }
      ],
      'floor3.png': [
        { value: 'path_F3_Lab.png', text: 'Advanced Engineering Lab' },
        { value: 'path_F3_Conference.png', text: 'Main Conference Room' }
      ]
    };

    // State variables
    let scale = 1;
    let posX = 0;
    let posY = 0;
    let dragging = false;
    let lastX, lastY;
    let currentPath = null;

    // Function to update path selector based on selected floor
    function updatePathOptions() {
      const selectedFloor = floorSelector.value;
      const options = floorOptions[selectedFloor] || [];
      
      // Clear current options
      pathSelector.innerHTML = '<option value="">-- Select Destination --</option>';
      
      // Add new options
      options.forEach(option => {
        const optElement = document.createElement('option');
        optElement.value = option.value;
        optElement.textContent = option.text;
        pathSelector.appendChild(optElement);
      });
      
      // Reset to floor plan view when floor changes
      showFloorPlan();
    }

    // Function to show only the path (replacing floor plan)
    function showPathOnly() {
      floorImg.style.display = 'none';
      pathImg.style.display = 'block';
    }

    // Function to show floor plan (default view)
    function showFloorPlan() {
      floorImg.style.display = 'block';
      pathImg.style.display = 'none';
      currentPath = null;
      pathSelector.value = '';
    }

    // Apply transform to both images
    function updateTransform() {
      const transform = `translate(${posX}px, ${posY}px) scale(${scale})`;
      floorImg.style.transform = transform;
      pathImg.style.transform = transform;
    }

    // Center the image in the container
    function centerImage() {
      const containerRect = container.getBoundingClientRect();
      const imgWidth = floorImg.naturalWidth || 1000;
      const imgHeight = floorImg.naturalHeight || 800;

      // Reset scale to 1
      scale = 1;

      // Center position
      posX = (containerRect.width - imgWidth) / 2;
      posY = (containerRect.height - imgHeight) / 2;

      updateTransform();
    }

    // Reset view to initial state
    function resetView() {
      centerImage();
    }

    // Event Listeners
    floorSelector.addEventListener('change', () => {
      const floorImage = floorSelector.value;
      floorImg.src = floorImage;
      
      // Update path options based on selected floor
      updatePathOptions();
      
      // Wait for the floor image to load before centering
      floorImg.onload = centerImage;
    });

    pathSelector.addEventListener('change', () => {
      const pathImage = pathSelector.value;
      if (pathImage) {
        pathImg.src = pathImage;
        currentPath = pathImage;
        
        // Show only the path image, replacing the floor plan
        showPathOnly();
      } else {
        // Show floor plan if no destination is selected
        showFloorPlan();
      }
    });

    // Zoom buttons
    zoomInBtn.addEventListener('click', () => {
      scale *= 1.2;
      updateTransform();
    });

    zoomOutBtn.addEventListener('click', () => {
      scale *= 0.8;
      updateTransform();
    });

    resetViewBtn.addEventListener('click', resetView);

    // Mouse controls for pan and zoom
    container.addEventListener('wheel', (e) => {
      e.preventDefault();
      const zoomSpeed = 0.001;
      const rect = container.getBoundingClientRect();
      
      // Mouse position in container
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      
      // Position relative to image
      const offsetX = (mouseX - posX) / scale;
      const offsetY = (mouseY - posY) / scale;
      
      // Adjust scale
      scale *= e.deltaY < 0 ? (1 + zoomSpeed * 100) : (1 - zoomSpeed * 100);
      scale = Math.min(Math.max(0.5, scale), 3);
      
      // Keep mouse point anchored
      posX = mouseX - offsetX * scale;
      posY = mouseY - offsetY * scale;
      
      updateTransform();
    });

    // Drag to pan
    container.addEventListener('mousedown', (e) => {
      dragging = true;
      lastX = e.clientX;
      lastY = e.clientY;
    });

    container.addEventListener('mousemove', (e) => {
      if (dragging) {
        posX += e.clientX - lastX;
        posY += e.clientY - lastY;
        lastX = e.clientX;
        lastY = e.clientY;
        updateTransform();
      }
    });

    container.addEventListener('mouseup', () => {
      dragging = false;
    });

    container.addEventListener('mouseleave', () => {
      dragging = false;
    });

    // Touch controls for mobile devices
    let touchStartDistance = 0;
    let touchStartScale = 1;

    container.addEventListener('touchstart', (e) => {
      if (e.touches.length === 2) {
        // Pinch zoom
        touchStartDistance = Math.hypot(
          e.touches[0].clientX - e.touches[1].clientX,
          e.touches[0].clientY - e.touches[1].clientY
        );
        touchStartScale = scale;
      } else if (e.touches.length === 1) {
        // Start drag
        dragging = true;
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
      }
    }, { passive: true });

    container.addEventListener('touchmove', (e) => {
      if (e.touches.length === 2) {
        // Pinch zoom
        const touchDistance = Math.hypot(
          e.touches[0].clientX - e.touches[1].clientX,
          e.touches[0].clientY - e.touches[1].clientY
        );
        scale = touchStartScale * (touchDistance / touchStartDistance);
        scale = Math.min(Math.max(0.5, scale), 3);
        updateTransform();
      } else if (e.touches.length === 1 && dragging) {
        // Drag
        posX += e.touches[0].clientX - lastX;
        posY += e.touches[0].clientY - lastY;
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
        updateTransform();
      }
    }, { passive: true });

    container.addEventListener('touchend', () => {
      dragging = false;
    });

    // Initialize with first floor
    window.addEventListener('load', () => {
      // Load the first floor image
      floorImg.src = floorSelector.value;
      
      // Update path options for the initial floor
      updatePathOptions();
      
      // Wait for the floor image to load before centering
      floorImg.onload = centerImage;
    });
  </script>
</body>

</html>
